<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>密码重置-达内BBS</title>
<!--导入bootstrap框架-->
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hc/index.css" rel="stylesheet">
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
		

<style type="text/css">
.logo {
	height: 65px;
	width: 151px;
	float: right;
}

.a2 {
	height: 45px;
	font-size: 25px;
}
.div5 {
			background: #656565;
			color: #aaa;
		}
			.yejiao  {
			text-align: center;
			margin-top: 40px;
		}
		
			.a1 {
			color: #AAAAAA;
		}
		
.zc {
	text-align: center;
	margin-top: 20px;
}

.login {
	margin-top: 20px;
	border-left: solid #dfdfdf 1px;
	padding-left: 2px;
}

.b1 {
	background-color: #FAFAFA
}

.div1 {
	background-color: #FFFFFF
}

#b2 {
	font-size: 20px;
}
.div-b2{
text-align: center;
}

	.yejiao1 {
			text-align: center;
		}
</style>
</head>
<body>
	<div class="container-fluid">
		<div class="row div1">
			<!--点击顶部达内教育图片回到主页-->

			<div class="col-sm-2">
				<a href=""><img src="imgs/lys/tedu_logo.gif" href="#"
					class="logo"></a>
			</div>
			<div class="col-sm-2 login">
				<div class="collapse navbar-collapse a2">

					<b>密码重置</b>

				</div>
			</div>
			<div class="col-sm-4"></div>
			<div class="col-sm-3">
				<div class="zc">
					<b>没有账号？立即</b> <a href="register2.html">注册|</a> <a class="hqsy" href="homepage.html">论坛首页</a>
				</div>
			</div>
		</div>
	</div>
	<div class="container  b1">
		<div class="col-sm-2 "></div>
		<div class="col-sm-8 div1">
			<div class="col-sm-5"></div>
			<br><br><br><br><br><br>
			<div class="row div-b2">
				<b id="b2">手机找回</b>
			</div><br>
			
			
			
			<div  class="row" >
				<b style="margin-left:24%">手机号:</b> &emsp; &emsp;&nbsp;&emsp;&nbsp;
				<input type="text" placeholder="请输入手机号" name="phone" id="phone" onblur="checkphone()"
				 onfocus="setMsg('','err-msg1')" class="form-control" style="width: 200px;display:inline">
				<button type="button"  disabled="false" id="send-verificationcode">发送验证码</button>
				<b id="err-msg1" style="color: red"></b>
			</div><br>
			<div  class="row" >
				<b style="margin-left:24%">手机验证码:</b> &emsp; &nbsp;&nbsp;
				<input type="text" placeholder="请输入验证码" class="form-control" name="verification-code" id="vCode" onblur="checkvCode()"
				 onfocus="setMsg('','err-msg2')" style="width: 200px;display:inline">&emsp;
				<b id="err-msg2" style="color: red"></b>
			</div><br>
			<div  class="row" >
				<b style="margin-left:24%">密码:</b>&emsp;&emsp;&emsp;&emsp;&emsp;
				<input type="password" name="pwd" class="form-control" id="pwd" onblur="checkpwd()"
				 onfocus="setMsg('','err-msg3')" style="width: 200px;display:inline"/>
				<b id="err-msg3" style="color: red"></b>
			</div><br>
			<div  class="row" style="text-align: center;" >
				<button type="button" class="btn btn-info" style="width: 150px"  id="submit1"> 提交</button>
				
			</div>
			

			<div class="col-sm-5"></div>
		</div>
		
		<div class="col-sm-2"></div>
		
		<div class="row" style="height: 800px"></div>
	</div>
	
	
	<div class="row div5">
				<div class="yejiao">
					<a target="_blank" href=" " class="a1">达内BBS论坛</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">www.tedu.cn</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">官方微博</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">诚聘精英</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">广告服务</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">联系方式</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">隐私政策</a><b>&ensp;&ensp;|&ensp;&ensp;</b>
					<a target="_blank" href=" " class="a1">服务条款</a>
				</div>
				<div class="yejiao1">
					<p>达内BBS论坛 版权所有</p>
				</div>

			</div>

</body>

<script type="text/javascript">
	$(function(){
		
	   $("#submit1").click(updateByPhone); 
		
	})
		
   
  
	

	function updateByPhone() {
		
		var phone = $("#phone").val().trim();
		var pwd = $("#pwd").val().trim();
		var checkPhoneMsg = $("#err-msg1").html();
		var checkPwdMsg = $("#err-msg3").html();

		if (checkPhoneMsg.length==0 &&checkPwdMsg=="密码格式正确" ) {
			 var url = "updateByPhone";
			var params = {
				"phone" : phone,
				"password" : pwd
			};
			
			$.getJSON(url, params, function(result) { //响应结束运行此函数
				console.log(result.state);
				alert(result.message)
			}); 
		}else{
			
		}
	}

	function checkphone() {
		var phone = $("#phone").val().trim();
		if (phone == "") {
			setMsg("手机号不能为空!", "err-msg1");
			return;
		} else {
			var url = "findByPhone";
			var params = {
				"phone" : phone
			};
			$.getJSON(url, params, function(result) { //响应结束运行此函数
				console.log(result.state);
				doHandleResponseResult(result);

			});//getJSON是一个特殊get函数

		}
	}
	function checkvCode() {
		var vCode = $("#vCode").val().trim();
		if (vCode == "") {
			setMsg("验证码不能为空!", "err-msg2");
			return;
		}
	}
	function checkpwd() {
		var pwd = $("#pwd").val().trim();

		if (pwd == "") {
			setMsg("密码不能为空!", "err-msg3");
			return;
		} else {
			var url = "checkPasswordformat";
			var params = {
				"password" : pwd
			};
			$.getJSON(url, params, function(result) { //响应结束运行此函数
				console.log(result.state);
				setMsg(result.message, "err-msg3");

			});

		}
	}
	function doHandleResponseResult(result) {

		if (result.state == 1) {
			$("#send-verificationcode").prop("disabled", false);

		} else {
			setMsg(result.message, "err-msg1");
			$("#send-verificationcode").prop("disabled", true);
		}

	}

	function setMsg(msg, id) {
		$("#" + id).html(msg)
	}
</script>
</html>